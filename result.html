<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Result</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1E1E1E"/>
  <style>
    body{background:#1E1E1E;color:#fff;font-family:Inter,system-ui,Arial,Helvetica,sans-serif;margin:0;padding:0}
    .container{max-width:1200px;margin:0 auto;padding:32px}
    .card{background:#2D2D2D;border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,0.3);}
    img{width:100%;height:auto;border-radius:12px;border:1px solid #3a3a3a}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
    .error{background:#3b0000;padding:16px;border-radius:12px;border:1px solid #7a0000}
    .kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
    .kpi{background:#1E1E1E;padding:12px;border-radius:12px;text-align:center;border:1px solid #3a3a3a}
    .back{display:inline-block;margin:16px 0;text-decoration:none;color:#00D4FF}
    @media(max-width:800px){.grid{grid-template-columns:1fr}.kpis{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="container">
    {% if error %}
      <div class="card error"><b>Error:</b> {{ error }}</div>
      <a class="back" href="/">← Try again</a>
    {% else %}
      <div class="card">
        <h2>📅 {{ date }}</h2>
        <div class="kpis">
          <div class="kpi">🔢 Points<br><b>{{ summary.points }}</b></div>
          <div class="kpi">📈 Avg Mass<br><b>{{ '%.2f'|format(summary.avg_mass) }} kg</b></div>
          <div class="kpi">📊 Mass Std<br><b>{{ '%.2f'|format(summary.std_mass) }} kg</b></div>
          <div class="kpi">⚡ Avg Pressure<br><b>{{ '%.2f'|format(summary.avg_pressure) }} psi</b></div>
          <div class="kpi">📊 Pressure Std<br><b>{{ '%.2f'|format(summary.std_pressure) }} psi</b></div>
          <div class="kpi">🔄 Max Mass Δ<br><b>{{ '%.2f'|format(summary.max_mass_change) }} kg</b></div>
          <div class="kpi">🔄 Max Pressure Δ<br><b>{{ '%.2f'|format(summary.max_pressure_change) }} psi</b></div>
        </div>
        <div style="margin-top:16px">
          <img alt="Dashboard" src="data:image/png;base64,{{ image_data }}" />
        </div>
        <a class="back" href="/">← Generate another date</a>
      </div>
    {% endif %}
  </div>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js');
      });
    }
  </script>
</body>
</html>
